{% extends "layout.html" %}

{% block title %}{% endblock %}

{% block page_content %}
<div class="scroll-container">
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/banner.svg') }}" alt="Section 1" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b2.svg') }}" alt="Section 2" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b3.svg') }}" alt="Section 3" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b4.svg') }}" alt="Section 4" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b5.svg') }}" alt="Section 5" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b6.svg') }}" alt="Section 6" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b7.svg') }}" alt="Section 7" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b8.svg') }}" alt="Section 8" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b9.svg') }}" alt="Section 9" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b10.svg') }}" alt="Section 10" class="scroll-image">
  </div>
  <div class="scroll-item">
    <img src="{{ url_for('static', filename='home_assets/b11.svg') }}" alt="Section 11" class="scroll-image">
  </div>
</div>

<div class="vine-container">
  <svg id="vine-svg" width="100" height="100%">
    <path id="vine-path" d="M 50,0 Q 75,50 50,100 T 50,200" fill="transparent" stroke="green" stroke-width="2"/>
  </svg>
</div>

<style>
  .scroll-container {
    width: 100%;
    overflow-y: scroll;
    height: 100vh;
    scroll-behavior: smooth;
    will-change: transform;
    scroll-snap-type: y mandatory;
  }
  .scroll-item {
    width: 1920px;
    height: 1078px;
    flex-shrink: 0;
    scroll-snap-align: start;
  }
  .scroll-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  body {
    overflow: hidden;
  }
  .vine-container {
    position: fixed;
    top: 0;
    right: 10px; /* Adjust this value to position the vine */
    width: 100px;
    height: 100vh;
    pointer-events: none;
  }
  .leaf {
    fill: green;
  }
</style>


<script>
  let vineHeight = 0;
  let vineWidth = 2;
  const vinePathD = ["M 50,0"];
  const maxVineLength = 5000; // Maximum length of the vine path

  const addLeaf = (x, y) => {
    const vineSvg = document.getElementById('vine-svg');
    const leaf = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    leaf.setAttribute('cx', x);
    leaf.setAttribute('cy', y);
    leaf.setAttribute('r', 5);
    leaf.classList.add('leaf');
    vineSvg.appendChild(leaf);
  };

  const updateVine = (delta) => {
    const vinePath = document.getElementById('vine-path');
    if (delta > 0) {
      vineHeight += 20; // Increase the height increment
      vineWidth = Math.min(vineWidth + 0.1, 10); // Increase the width increment but cap it

      if (vineHeight >= maxVineLength) return; // Prevent exceeding the maximum length
      const controlX = 50 + Math.random() * 50;
      const controlY = vineHeight - 20;
      vinePathD.push(`Q ${controlX},${controlY} 50,${vineHeight}`);

      vinePath.setAttribute('d', vinePathD.join(" "));
      vinePath.setAttribute('stroke-width', vineWidth);
      addLeaf(50, vineHeight);
    } else if (delta < 0 && vineHeight > 20) {
      vineHeight -= 20; // Decrease the height increment
      vineWidth = Math.max(vineWidth - 0.1, 2); // Decrease the width increment but keep it above 2

      vinePathD.pop(); // Remove the last segment
      vinePath.setAttribute('d', vinePathD.join(" "));
      vinePath.setAttribute('stroke-width', vineWidth);

      const vineSvg = document.getElementById('vine-svg');
      if (vineSvg.lastChild.tagName === 'circle') {
        vineSvg.removeChild(vineSvg.lastChild);
      }
    }
  };

  document.addEventListener('wheel', function(e) {
    e.preventDefault();
    const container = document.querySelector('.scroll-container');
    const delta = Math.sign(e.deltaY);
    container.scrollBy({
      top: delta * 1200, // Adjust the scroll distance to match the item height
      behavior: 'smooth'
    });

    updateVine(delta);
  }, { passive: false });

  document.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
      e.preventDefault();
      const container = document.querySelector('.scroll-container');
      const delta = e.key === 'ArrowDown' ? 1 : -1;
      container.scrollBy({
        top: delta * 1200, // Adjust the scroll distance to match the item height
        behavior: 'smooth'
      });

      updateVine(delta);
    }
  });
</script>


{% endblock %}
